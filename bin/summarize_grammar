#! /bin/zsh

summary_chapter="TSPL.docc/ReferenceManual/SummaryOfTheGrammar.md"

if [[ -f $summary_chapter ]]
then
	echo "Refusing to overright existing file."
	exit 1
fi

{
	echo "# Summary of the Grammar"
	echo
	echo "Read the whole formal grammar."
	echo
	awk -f bin/extract_grammar.awk TSPL.docc/ReferenceManual/LexicalStructure.md
	awk -f bin/extract_grammar.awk TSPL.docc/ReferenceManual/Types.md
	awk -f bin/extract_grammar.awk TSPL.docc/ReferenceManual/Expressions.md
	awk -f bin/extract_grammar.awk TSPL.docc/ReferenceManual/Statements.md
	awk -f bin/extract_grammar.awk TSPL.docc/ReferenceManual/Declarations.md
	awk -f bin/extract_grammar.awk TSPL.docc/ReferenceManual/Attributes.md
	awk -f bin/extract_grammar.awk TSPL.docc/ReferenceManual/Patterns.md
	awk -f bin/extract_grammar.awk TSPL.docc/ReferenceManual/GenericParametersAndArguments.md
	echo
	echo "<!--"
	echo "This source file is part of the Swift.org open source project"
	echo ""
	echo "Copyright (c) 2014 - 2022 Apple Inc. and the Swift project authors"
	echo "Licensed under Apache License v2.0 with Runtime Library Exception"
	echo ""
	echo "See https://swift.org/LICENSE.txt for license information"
	echo "See https://swift.org/CONTRIBUTORS.txt for the list of Swift project authors"
	echo "-->"
} > $summary_chapter
