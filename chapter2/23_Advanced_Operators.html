<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head>
        
        <meta charset=big5"UTF-8">
        <title>《The Swift Programming Language》中文版</title>
        <meta content="text/html; charset=big5" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.5.2">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <meta name="author" content="https:">
    
    
    <link rel="next" href="../chapter3/chapter3.html" />
    
    
    <link rel="prev" href="../chapter2/22_Generics.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book" data-github="https://github.com/numbbbbb/the-swift-programming-language-in-chinese" data-level="2.23" data-basepath=".." data-revision="1402976636475">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/https://github.com/numbbbbb/the-swift-programming-language-in-chinese" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/numbbbbb/the-swift-programming-language-in-chinese/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/numbbbbb/the-swift-programming-language-in-chinese/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >The Swift Programming Language 中文版</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/https:" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/numbbbbb/the-swift-programming-language-in-chinese/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/numbbbbb/the-swift-programming-language-in-chinese/edit/master/chapter2/23_Advanced_Operators.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> 序</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="chapter1/chapter1.html">
            
            <a href="../chapter1/chapter1.html">
                <i class="fa fa-check"></i> <b>1.</b> 歡迎使用 Swift
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="chapter1/01_swift.html">
            
            <a href="../chapter1/01_swift.html">
                <i class="fa fa-check"></i> <b>1.1.</b> 關於 Swift
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="chapter1/02_a_swift_tour.html">
            
            <a href="../chapter1/02_a_swift_tour.html">
                <i class="fa fa-check"></i> <b>1.2.</b> Swift 初見
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="chapter2/chapter2.html">
            
            <a href="../chapter2/chapter2.html">
                <i class="fa fa-check"></i> <b>2.</b> Swift 教程
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="chapter2/01_The_Basics.html">
            
            <a href="../chapter2/01_The_Basics.html">
                <i class="fa fa-check"></i> <b>2.1.</b> 基礎部分
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="chapter2/02_Basic_Operators.html">
            
            <a href="../chapter2/02_Basic_Operators.html">
                <i class="fa fa-check"></i> <b>2.2.</b> 基本運算符
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="chapter2/03_Strings_and_Characters.html">
            
            <a href="../chapter2/03_Strings_and_Characters.html">
                <i class="fa fa-check"></i> <b>2.3.</b> 字符串和字符
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="chapter2/04_Collection_Types.html">
            
            <a href="../chapter2/04_Collection_Types.html">
                <i class="fa fa-check"></i> <b>2.4.</b> 集合類型
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="chapter2/05_Control_Flow.html">
            
            <a href="../chapter2/05_Control_Flow.html">
                <i class="fa fa-check"></i> <b>2.5.</b> 控制流
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="chapter2/06_Functions.html">
            
            <a href="../chapter2/06_Functions.html">
                <i class="fa fa-check"></i> <b>2.6.</b> 函數
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="chapter2/07_Closures.html">
            
            <a href="../chapter2/07_Closures.html">
                <i class="fa fa-check"></i> <b>2.7.</b> 閉包
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="chapter2/08_Enumerations.html">
            
            <a href="../chapter2/08_Enumerations.html">
                <i class="fa fa-check"></i> <b>2.8.</b> 枚舉
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="chapter2/09_Classes_and_Structures.html">
            
            <a href="../chapter2/09_Classes_and_Structures.html">
                <i class="fa fa-check"></i> <b>2.9.</b> 類和結構體
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="chapter2/10_Properties.html">
            
            <a href="../chapter2/10_Properties.html">
                <i class="fa fa-check"></i> <b>2.10.</b> 屬性
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="chapter2/11_Methods.html">
            
            <a href="../chapter2/11_Methods.html">
                <i class="fa fa-check"></i> <b>2.11.</b> 方法
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="chapter2/12_Subscripts.html">
            
            <a href="../chapter2/12_Subscripts.html">
                <i class="fa fa-check"></i> <b>2.12.</b> 下標腳本
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="chapter2/13_Inheritance.html">
            
            <a href="../chapter2/13_Inheritance.html">
                <i class="fa fa-check"></i> <b>2.13.</b> 繼承
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="chapter2/14_Initialization.html">
            
            <a href="../chapter2/14_Initialization.html">
                <i class="fa fa-check"></i> <b>2.14.</b> 構造過程
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="chapter2/15_Deinitialization.html">
            
            <a href="../chapter2/15_Deinitialization.html">
                <i class="fa fa-check"></i> <b>2.15.</b> 析構過程
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="chapter2/16_Automatic_Reference_Counting.html">
            
            <a href="../chapter2/16_Automatic_Reference_Counting.html">
                <i class="fa fa-check"></i> <b>2.16.</b> 自動引用計數
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="chapter2/17_Optional_Chaining.html">
            
            <a href="../chapter2/17_Optional_Chaining.html">
                <i class="fa fa-check"></i> <b>2.17.</b> 可選鏈
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="chapter2/18_Type_Casting.html">
            
            <a href="../chapter2/18_Type_Casting.html">
                <i class="fa fa-check"></i> <b>2.18.</b> 類型檢查
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="chapter2/19_Nested_Types.html">
            
            <a href="../chapter2/19_Nested_Types.html">
                <i class="fa fa-check"></i> <b>2.19.</b> 嵌套類型
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="chapter2/20_Extensions.html">
            
            <a href="../chapter2/20_Extensions.html">
                <i class="fa fa-check"></i> <b>2.20.</b> 擴展
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.21" data-path="chapter2/21_Protocols.html">
            
            <a href="../chapter2/21_Protocols.html">
                <i class="fa fa-check"></i> <b>2.21.</b> 協議
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.22" data-path="chapter2/22_Generics.html">
            
            <a href="../chapter2/22_Generics.html">
                <i class="fa fa-check"></i> <b>2.22.</b> 泛型
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.23" data-path="chapter2/23_Advanced_Operators.html">
            
            <a href="../chapter2/23_Advanced_Operators.html">
                <i class="fa fa-check"></i> <b>2.23.</b> 高級操作符
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="chapter3/chapter3.html">
            
            <a href="../chapter3/chapter3.html">
                <i class="fa fa-check"></i> <b>3.</b> 語言參考
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="chapter3/01_About_the_Language_Reference.html">
            
            <a href="../chapter3/01_About_the_Language_Reference.html">
                <i class="fa fa-check"></i> <b>3.1.</b> 關於語言參考
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="chapter3/02_Lexical_Structure.html">
            
            <a href="../chapter3/02_Lexical_Structure.html">
                <i class="fa fa-check"></i> <b>3.2.</b> 詞法結構
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="chapter3/03_Types.html">
            
            <a href="../chapter3/03_Types.html">
                <i class="fa fa-check"></i> <b>3.3.</b> 類型
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="chapter3/04_Expressions.html">
            
            <a href="../chapter3/04_Expressions.html">
                <i class="fa fa-check"></i> <b>3.4.</b> 表達式
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="chapter3/10_Statements.html">
            
            <a href="../chapter3/10_Statements.html">
                <i class="fa fa-check"></i> <b>3.5.</b> 語句
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="chapter3/05_Declarations.html">
            
            <a href="../chapter3/05_Declarations.html">
                <i class="fa fa-check"></i> <b>3.6.</b> 聲明
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="chapter3/06_Attributes.html">
            
            <a href="../chapter3/06_Attributes.html">
                <i class="fa fa-check"></i> <b>3.7.</b> 特性
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="chapter3/07_Patterns.html">
            
            <a href="../chapter3/07_Patterns.html">
                <i class="fa fa-check"></i> <b>3.8.</b> 模式
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="chapter3/08_Generic_Parameters_and_Arguments.html">
            
            <a href="../chapter3/08_Generic_Parameters_and_Arguments.html">
                <i class="fa fa-check"></i> <b>3.9.</b> 泛型參數
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="chapter3/09_Summary_of_the_Grammar.html">
            
            <a href="../chapter3/09_Summary_of_the_Grammar.html">
                <i class="fa fa-check"></i> <b>3.10.</b> 語法總結
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
<li style="margin-left:15%;"> <iframe  src="http://ghbtns.com/github-btn.html?user=numbbbbb&repo=the-swift-programming-language-in-chinese&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="170" height="30"></iframe></li><li><p style="padding-left:5px;padding-right:5px;">翻譯無任何商業目的，僅供內部學習交流使用！</p></li><li><script src="http://s19.cnzz.com/z_stat.php?id=1000480711&web_id=1000480711" language="JavaScript"></script></li>        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 52.63157894736842%;min-width: 50%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../chapter1/chapter1.html" title="歡迎使用 Swift" class="chapter done new-chapter" data-progress="1" style="left: 2.6315789473684212%;"></a>
    
        <a href="../chapter1/01_swift.html" title="關於 Swift" class="chapter done " data-progress="1.1" style="left: 5.2631578947368425%;"></a>
    
        <a href="../chapter1/02_a_swift_tour.html" title="Swift 初見" class="chapter done " data-progress="1.2" style="left: 7.894736842105263%;"></a>
    
        <a href="../chapter2/chapter2.html" title="Swift 教程" class="chapter done new-chapter" data-progress="2" style="left: 10.526315789473685%;"></a>
    
        <a href="../chapter2/01_The_Basics.html" title="基礎部分" class="chapter done " data-progress="2.1" style="left: 13.157894736842104%;"></a>
    
        <a href="../chapter2/10_Properties.html" title="屬性" class="chapter done " data-progress="2.10" style="left: 15.789473684210526%;"></a>
    
        <a href="../chapter2/11_Methods.html" title="方法" class="chapter done " data-progress="2.11" style="left: 18.42105263157895%;"></a>
    
        <a href="../chapter2/12_Subscripts.html" title="下標腳本" class="chapter done " data-progress="2.12" style="left: 21.05263157894737%;"></a>
    
        <a href="../chapter2/13_Inheritance.html" title="繼承" class="chapter done " data-progress="2.13" style="left: 23.68421052631579%;"></a>
    
        <a href="../chapter2/14_Initialization.html" title="構造過程" class="chapter done " data-progress="2.14" style="left: 26.31578947368421%;"></a>
    
        <a href="../chapter2/15_Deinitialization.html" title="析構過程" class="chapter done " data-progress="2.15" style="left: 28.94736842105263%;"></a>
    
        <a href="../chapter2/16_Automatic_Reference_Counting.html" title="自動引用計數" class="chapter done " data-progress="2.16" style="left: 31.57894736842105%;"></a>
    
        <a href="../chapter2/17_Optional_Chaining.html" title="可選鏈" class="chapter done " data-progress="2.17" style="left: 34.21052631578947%;"></a>
    
        <a href="../chapter2/18_Type_Casting.html" title="類型檢查" class="chapter done " data-progress="2.18" style="left: 36.8421052631579%;"></a>
    
        <a href="../chapter2/19_Nested_Types.html" title="嵌套類型" class="chapter done " data-progress="2.19" style="left: 39.473684210526315%;"></a>
    
        <a href="../chapter2/02_Basic_Operators.html" title="基本運算符" class="chapter done " data-progress="2.2" style="left: 42.10526315789474%;"></a>
    
        <a href="../chapter2/20_Extensions.html" title="擴展" class="chapter done " data-progress="2.20" style="left: 44.73684210526316%;"></a>
    
        <a href="../chapter2/21_Protocols.html" title="協議" class="chapter done " data-progress="2.21" style="left: 47.36842105263158%;"></a>
    
        <a href="../chapter2/22_Generics.html" title="泛型" class="chapter done " data-progress="2.22" style="left: 50%;"></a>
    
        <a href="../chapter2/23_Advanced_Operators.html" title="高級操作符" class="chapter done " data-progress="2.23" style="left: 52.63157894736842%;"></a>
    
        <a href="../chapter2/03_Strings_and_Characters.html" title="字符串和字符" class="chapter  " data-progress="2.3" style="left: 55.26315789473684%;"></a>
    
        <a href="../chapter2/04_Collection_Types.html" title="集合類型" class="chapter  " data-progress="2.4" style="left: 57.89473684210526%;"></a>
    
        <a href="../chapter2/05_Control_Flow.html" title="控制流" class="chapter  " data-progress="2.5" style="left: 60.526315789473685%;"></a>
    
        <a href="../chapter2/06_Functions.html" title="函數" class="chapter  " data-progress="2.6" style="left: 63.1578947368421%;"></a>
    
        <a href="../chapter2/07_Closures.html" title="閉包" class="chapter  " data-progress="2.7" style="left: 65.78947368421052%;"></a>
    
        <a href="../chapter2/08_Enumerations.html" title="枚舉" class="chapter  " data-progress="2.8" style="left: 68.42105263157895%;"></a>
    
        <a href="../chapter2/09_Classes_and_Structures.html" title="類和結構體" class="chapter  " data-progress="2.9" style="left: 71.05263157894737%;"></a>
    
        <a href="../chapter3/chapter3.html" title="語言參考" class="chapter  new-chapter" data-progress="3" style="left: 73.6842105263158%;"></a>
    
        <a href="../chapter3/01_About_the_Language_Reference.html" title="關於語言參考" class="chapter  " data-progress="3.1" style="left: 76.3157894736842%;"></a>
    
        <a href="../chapter3/09_Summary_of_the_Grammar.html" title="語法總結" class="chapter  " data-progress="3.10" style="left: 78.94736842105263%;"></a>
    
        <a href="../chapter3/02_Lexical_Structure.html" title="詞法結構" class="chapter  " data-progress="3.2" style="left: 81.57894736842105%;"></a>
    
        <a href="../chapter3/03_Types.html" title="類型" class="chapter  " data-progress="3.3" style="left: 84.21052631578948%;"></a>
    
        <a href="../chapter3/04_Expressions.html" title="表達式" class="chapter  " data-progress="3.4" style="left: 86.84210526315789%;"></a>
    
        <a href="../chapter3/10_Statements.html" title="語句" class="chapter  " data-progress="3.5" style="left: 89.47368421052632%;"></a>
    
        <a href="../chapter3/05_Declarations.html" title="聲明" class="chapter  " data-progress="3.6" style="left: 92.10526315789474%;"></a>
    
        <a href="../chapter3/06_Attributes.html" title="特性" class="chapter  " data-progress="3.7" style="left: 94.73684210526316%;"></a>
    
        <a href="../chapter3/07_Patterns.html" title="模式" class="chapter  " data-progress="3.8" style="left: 97.36842105263158%;"></a>
    
        <a href="../chapter3/08_Generic_Parameters_and_Arguments.html" title="泛型參數" class="chapter  " data-progress="3.9" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_636">
                    
                        <blockquote>
<p>翻譯：<a href="https://github.com/xielingwang" target="_blank">xielingwang</a><br>校對：<a href="https://github.com/numbbbbb" target="_blank">numbbbbb</a></p>
</blockquote>
<h1 id="-">高級運算符</h1>
<hr>
<p>本頁內容包括：</p>
<ul>
<li><a href="#bitwise_operators">位運算符</a></li>
<li><a href="#overflow_operators">溢出運算符</a></li>
<li><a href="#precedence_and_associativity">優先級和結合性(Precedence and Associativity)</a></li>
<li><a href="#operator_functions">運算符函數(Operator Functions)</a></li>
<li><a href="#custom_operators">自定義運算符</a></li>
</ul>
<p>除了<a href="02_Basic_Operators.html">基本操作符</a>中所講的運算符，Swift還有許多複雜的高級運算符，包括了C語和Objective-C中的位運算符和移位運算。</p>
<p>不同於C語言中的數值計算，Swift的數值計算默認是不可溢出的。溢出行為會被捕獲並報告為錯誤。你是故意的？好吧，你可以使用Swift為你準備的另一套默認允許溢出的數值運算符，如可溢出加<code>&amp;+</code>。所有允許溢出的運算符都是以<code>&amp;</code>開始的。</p>
<p>自定義的結構，類和枚舉，是否可以使用標準的運算符來定義操作？當然可以！在Swift中，你可以為你創建的所有類型定制運算符的操作。</p>
<p>可定制的運算符並不限於那些預設的運算符，自定義有個性的中置，前置，後置及賦值運算符，當然還有優先級和結合性。這些運算符的實現可以運用預設的運算符，也可以運用之前定制的運算符。</p>
<p><a name="bitwise_operators"></a></p>
<h2 id="-">位運算符</h2>
<p>位操作符通常在諸如圖像處理和創建設備驅動等底層開發中使用，使用它可以單獨操作數據結構中原始數據的比特位。在使用一個自定義的協議進行通信的時候，運用位運算符來對原始數據進行編碼和解碼也是非常有效的。</p>
<p>Swift支持如下所有C語言的位運算符：</p>
<h3 id="-">按位取反運算符</h3>
<p>按位取反運算符<code>~</code>對一個操作數的每一位都取反。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitwiseNOT_2x.png" alt="Art/bitwiseNOT_2x.png" title="Art/bitwiseNOT_2x.png"></p>
<p>這個運算符是前置的，所以請不加任何空格地寫著操作數之前。</p>
<pre><code class="lang-swift">let initialBits: UInt8 = 0b00001111
let invertedBits = ~initialBits  // 等於 0b11110000
</code></pre>
<p><code>UInt8</code>是8位無符整型，可以存儲0~255之間的任意數。這個例子初始化一個整型為二進制值<code>00001111</code>(前4位為<code>0</code>，後4位為<code>1</code>)，它的十進制值為<code>15</code>。</p>
<p>使用按位取反運算<code>~</code>對<code>initialBits</code>操作，然後賦值給<code>invertedBits</code>這個新常量。這個新常量的值等於所有位都取反的<code>initialBits</code>，即<code>1</code>變成<code>0</code>，<code>0</code>變成<code>1</code>，變成了<code>11110000</code>，十進制值為<code>240</code>。</p>
<h3 id="-">按位與運算符</h3>
<p>按位與運算符對兩個數進行操作，然後返回一個新的數，這個數的每個位都需要兩個輸入數的同一位都為1時才為1。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitwiseAND_2x.png" alt="Art/bitwiseAND_2x.png" title="Art/bitwiseAND_2x.png"></p>
<p>以下代碼，<code>firstSixBits</code>和<code>lastSixBits</code>中間4個位都為1。對它倆進行按位與運算後，就得到了<code>00111100</code>，即十進制的<code>60</code>。</p>
<pre><code class="lang-swift">let firstSixBits: UInt8 = 0b11111100
let lastSixBits: UInt8  = 0b00111111
let middleFourBits = firstSixBits &amp; lastSixBits  // 等於 00111100
</code></pre>
<h3 id="-">按位或運算</h3>
<p>按位或運算符<code>|</code>比較兩個數，然後返回一個新的數，這個數的每一位設置1的條件是兩個輸入數的同一位都不為0(即任意一個為1，或都為1)。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitwiseOR_2x.png" alt="Art/bitwiseOR_2x.png" title="Art/bitwiseOR_2x.png"></p>
<p>如下代碼，<code>someBits</code>和<code>moreBits</code>在不同位上有<code>1</code>。按位或運行的結果是<code>11111110</code>，即十進制的<code>254</code>。</p>
<pre><code class="lang-swift">let someBits: UInt8 = 0b10110010
let moreBits: UInt8 = 0b01011110
let combinedbits = someBits | moreBits  // 等於 11111110
</code></pre>
<h3 id="-">按位異或運算符</h3>
<p>按位異或運算符<code>^</code>比較兩個數，然後返回一個數，這個數的每個位設為<code>1</code>的條件是兩個輸入數的同一位不同，如果相同就設為<code>0</code>。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitwiseXOR_2x.png" alt="Art/bitwiseXOR_2x.png" title="Art/bitwiseXOR_2x.png"></p>
<p>以下代碼，<code>firstBits</code>和<code>otherBits</code>都有一個<code>1</code>跟另一個數不同的。所以按位異或的結果是把它這些位置為<code>1</code>，其他都置為<code>0</code>。</p>
<pre><code class="lang-swift">let firstBits: UInt8 = 0b00010100
let otherBits: UInt8 = 0b00000101
let outputBits = firstBits ^ otherBits  // 等於 00010001
</code></pre>
<h3 id="-">按位左移/右移運算符</h3>
<p>左移運算符<code>&lt;&lt;</code>和右移運算符<code>&gt;&gt;</code>會把一個數的所有比特位按以下定義的規則向左或向右移動指定位數。</p>
<p>按位左移和按位右移的效果相當把一個整數乘於或除於一個因子為<code>2</code>的整數。向左移動一個整型的比特位相當於把這個數乘於<code>2</code>，向右移一位就是除於<code>2</code>。</p>
<h4 id="-">無符整型的移位操作</h4>
<p>對無符整型的移位的效果如下：</p>
<p>已經存在的比特位向左或向右移動指定的位數。被移出整型存儲邊界的的位數直接拋棄，移動留下的空白位用零<code>0</code>來填充。這種方法稱為邏輯移位。</p>
<p>以下這張把展示了 <code>11111111 &lt;&lt; 1</code>(<code>11111111</code>向左移1位)，和 <code>11111111 &gt;&gt; 1</code>(<code>11111111</code>向右移1位)。藍色的是被移位的，灰色是被拋棄的，橙色的<code>0</code>是被填充進來的。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitshiftUnsigned_2x.png" alt="Art/bitshiftUnsigned_2x.png" title="Art/bitshiftUnsigned_2x.png"></p>
<pre><code class="lang-swift">let shiftBits: UInt8 = 4   // 即二進制的00000100
shiftBits &lt;&lt; 1             // 00001000
shiftBits &lt;&lt; 2             // 00010000
shiftBits &lt;&lt; 5             // 10000000
shiftBits &lt;&lt; 6             // 00000000
shiftBits &gt;&gt; 2             // 00000001
</code></pre>
<p>你可以使用移位操作進行其他數據類型的編碼和解碼。</p>
<pre><code class="lang-swift">let pink: UInt32 = 0xCC6699
let redComponent = (pink &amp; 0xFF0000) &gt;&gt; 16    // redComponent 是 0xCC, 即 204
let greenComponent = (pink &amp; 0x00FF00) &gt;&gt; 8   // greenComponent 是 0x66, 即 102
let blueComponent = pink &amp; 0x0000FF           // blueComponent 是 0x99, 即 153
</code></pre>
<p>這個例子使用了一個<code>UInt32</code>的命名為<code>pink</code>的常量來存儲層疊樣式表<code>CSS</code>中粉色的顏色值，<code>CSS</code>顏色<code>#CC6699</code>在Swift用十六進制<code>0xCC6699</code>來表示。然後使用按位與(&amp;)和按位右移就可以從這個顏色值中解析出紅(CC)，綠(66)，藍(99)三個部分。</p>
<p>對<code>0xCC6699</code>和<code>0xFF0000</code>進行按位與<code>&amp;</code>操作就可以得到紅色部分。<code>0xFF0000</code>中的<code>0</code>了遮蓋了<code>OxCC6699</code>的第二和第三個字節，這樣<code>6699</code>被忽略了，只留下<code>0xCC0000</code>。</p>
<p>然後，按向右移動16位，即 <code>&gt;&gt; 16</code>。十六進制中每兩個字符是8比特位，所以移動16位的結果是把<code>0xCC0000</code>變成<code>0x0000CC</code>。這和<code>0xCC</code>是相等的，都是十進制的<code>204</code>。</p>
<p>同樣的，綠色部分來自於<code>0xCC6699</code>和<code>0x00FF00</code>的按位操作得到<code>0x006600</code>。然後向右移動8們，得到<code>0x66</code>，即十進制的<code>102</code>。</p>
<p>最後，藍色部分對<code>0xCC6699</code>和<code>0x0000FF</code>進行按位與運算，得到<code>0x000099</code>，無需向右移位了，所以結果就是<code>0x99</code>，即十進制的<code>153</code>。</p>
<h4 id="-">有符整型的移位操作</h4>
<p>有符整型的移位操作相對複雜得多，因為正負號也是用二進制位表示的。(這裡舉的例子雖然都是8位的，但它的原理是通用的。)</p>
<p>有符整型通過第1個比特位(稱為符號位)來表達這個整數是正數還是負數。<code>0</code>代表正數，<code>1</code>代表負數。</p>
<p>其餘的比特位(稱為數值位)存儲其實值。有符正整數和無符正整數在計算機裡的存儲結果是一樣的，下來我們來看<code>+4</code>內部的二進制結構。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitshiftSignedFour_2x.png" alt="Art/bitshiftSignedFour_2x.png" title="Art/bitshiftSignedFour_2x.png"></p>
<p>符號位為<code>0</code>，代表正數，另外7比特位二進製表示的實際值就剛好是<code>4</code>。</p>
<p>負數呢，跟正數不同。負數存儲的是2的n次方減去它的絕對值，n為數值位的位數。一個8比特的數有7個數值位，所以是2的7次方，即128。</p>
<p>我們來看<code>-4</code>存儲的二進制結構。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitshiftSignedMinusFour_2x.png" alt="Art/bitshiftSignedMinusFour_2x.png" title="Art/bitshiftSignedMinusFour_2x.png"></p>
<p>現在符號位為<code>1</code>，代表負數，7個數值位要表達的二進制值是124，即128 - 4。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitshiftSignedMinusFourValue_2x.png" alt="Art/bitshiftSignedMinusFourValue_2x.png" title="Art/bitshiftSignedMinusFourValue_2x.png"></p>
<p>負數的編碼方式稱為二進制補碼表示。這種表示方式看起來很奇怪，但它有幾個優點。</p>
<p>首先，只需要對全部8個比特位(包括符號)做標準的二進制加法就可以完成 <code>-1 + -4</code> 的操作，忽略加法過程產生的超過8個比特位表達的任何信息。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitshiftSignedAddition_2x.png" alt="Art/bitshiftSignedAddition_2x.png" title="Art/bitshiftSignedAddition_2x.png"></p>
<p>第二，由於使用二進制補碼表示，我們可以和正數一樣對負數進行按位左移右移的，同樣也是左移1位時乘於<code>2</code>，右移1位時除於<code>2</code>。要達到此目的，對有符整型的右移有一個特別的要求：</p>
<p>對有符整型按位右移時，使用符號位(正數為<code>0</code>，負數為<code>1</code>)填充空白位。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/bitshiftSigned_2x.png" alt="Art/bitshiftSigned_2x.png" title="Art/bitshiftSigned_2x.png"></p>
<p>這就確保了在右移的過程中，有符整型的符號不會發生變化。這稱為算術移位。</p>
<p>正因為正數和負數特殊的存儲方式，向右移位使它接近於<code>0</code>。移位過程中保持符號會不變，負數在接近<code>0</code>的過程中一直是負數。</p>
<p><a name="overflow_operators"></a></p>
<h2 id="-">溢出運算符</h2>
<p>默認情況下，當你往一個整型常量或變量賦於一個它不能承載的大數時，Swift不會讓你這麼幹的，它會報錯。這樣，在操作過大或過小的數的時候就很安全了。</p>
<p>例如，<code>Int16</code>整型能承載的整數範圍是<code>-32768</code>到<code>32767</code>，如果給它賦上超過這個範圍的數，就會報錯：</p>
<pre><code class="lang-swift">var potentialOverflow = Int16.max
// potentialOverflow 等於 32767, 這是 Int16 能承載的最大整數
potentialOverflow += 1
// 噢, 出錯了
</code></pre>
<p>對過大或過小的數值進行錯誤處理讓你的數值邊界條件更靈活。</p>
<p>當然，你有意在溢出時對有效位進行截斷，你可採用溢出運算，而非錯誤處理。Swfit為整型計算提供了5個<code>&amp;</code>符號開頭的溢出運算符。</p>
<ul>
<li>溢出加法 <code>&amp;+</code></li>
<li>溢出減法 <code>&amp;-</code></li>
<li>溢出乘法 <code>&amp;*</code></li>
<li>溢出除法 <code>&amp;/</code></li>
<li>溢出求余 <code>&amp;%</code></li>
</ul>
<h3 id="-">值的上溢出</h3>
<p>下面例子使用了溢出加法<code>&amp;+</code>來解剖的無符整數的上溢出</p>
<pre><code class="lang-swift">var willOverflow = UInt8.max
// willOverflow 等於UInt8的最大整數 255
willOverflow = willOverflow &amp;+ 1
// 這時候 willOverflow 等於 0
</code></pre>
<p><code>willOverflow</code>用<code>Int8</code>所能承載的最大值<code>255</code>(二進制<code>11111111</code>)，然後用<code>&amp;+</code>加1。然後<code>UInt8</code>就無法表達這個新值的二進制了，也就導致了這個新值上溢出了，大家可以看下圖。溢出後，新值在<code>UInt8</code>的承載範圍內的那部分是<code>00000000</code>，也就是<code>0</code>。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/overflowAddition_2x.png" alt="Art/overflowAddition_2x.png" title="Art/overflowAddition_2x.png"></p>
<h3 id="-">值的下溢出</h3>
<p>數值也有可能因為太小而越界。舉個例子：</p>
<p><code>UInt8</code>的最小值是<code>0</code>(二進制為<code>00000000</code>)。使用<code>&amp;-</code>進行溢出減1，就會得到二進制的<code>11111111</code>即十進制的<code>255</code>。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/overflowUnsignedSubtraction_2x.png" alt="Art/overflowUnsignedSubtraction_2x.png" title="Art/overflowUnsignedSubtraction_2x.png"></p>
<p>Swift代碼是這樣的:</p>
<pre><code class="lang-swift">var willUnderflow = UInt8.min
// willUnderflow 等於UInt8的最小值0
willUnderflow = willUnderflow &amp;- 1
// 此時 willUnderflow 等於 255
</code></pre>
<p>有符整型也有類似的下溢出，有符整型所有的減法也都是對包括在符號位在內的二進制數進行二進制減法的，這在 &quot;按位左移/右移運算符&quot; 一節提到過。最小的有符整數是<code>-128</code>，即二進制的<code>10000000</code>。用溢出減法減去去1後，變成了<code>01111111</code>，即UInt8所能承載的最大整數<code>127</code>。</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/overflowSignedSubtraction_2x.png" alt="Art/overflowSignedSubtraction_2x.png" title="Art/overflowSignedSubtraction_2x.png"></p>
<p>來看看Swift代碼：</p>
<pre><code class="lang-swift">var signedUnderflow = Int8.min
// signedUnderflow 等於最小的有符整數 -128
signedUnderflow = signedUnderflow &amp;- 1
// 如今 signedUnderflow 等於 127
</code></pre>
<h3 id="-">除零溢出</h3>
<p>一個數除於0 <code>i / 0</code>，或者對0求餘數 <code>i % 0</code>，就會產生一個錯誤。</p>
<pre><code class="lang-swift">let x = 1
let y = x / 0
</code></pre>
<p>使用它們對應的可溢出的版本的運算符<code>&amp;/</code>和<code>&amp;%</code>進行除0操作時就會得到<code>0</code>值。</p>
<pre><code class="lang-swift">let x = 1
let y = x &amp;/ 0
// y 等於 0
</code></pre>
<p><a name="precedence_and_associativity"></a></p>
<h2 id="-">優先級和結合性</h2>
<p>運算符的優先級使得一些運算符優先於其他運算符，高優先級的運算符會先被計算。</p>
<p>結合性定義相同優先級的運算符在一起時是怎麼組合或關聯的，是和左邊的一組呢，還是和右邊的一組。意思就是，到底是和左邊的表達式結合呢，還是和右邊的表達式結合？</p>
<p>在混合表達式中，運算符的優先級和結合性是非常重要的。舉個例子，為什麼下列表達式的結果為<code>4</code>？</p>
<pre><code class="lang-swift">2 + 3 * 4 % 5
// 結果是 4
</code></pre>
<p>如果嚴格地從左計算到右，計算過程會是這樣：</p>
<ul>
<li>2 + 3 = 5</li>
<li>5 * 4 = 20</li>
<li>20 / 5 = 4 余 0</li>
</ul>
<p>但是正確答案是<code>4</code>而不是<code>0</code>。優先級高的運算符要先計算，在Swift和C語言中，都是先乘除後加減的。所以，執行完乘法和求余運算才能執行加減運算。</p>
<p>乘法和求余擁有相同的優先級，在運算過程中，我們還需要結合性，乘法和求余運算都是左結合的。這相當於在表達式中有隱藏的括號讓運算從左開始。</p>
<pre><code class="lang-swift">2 + ((3 * 4) % 5)
</code></pre>
<p>3 * 4 = 12，所以這相當於：</p>
<pre><code class="lang-swift">2 + (12 % 5)
</code></pre>
<p>12 % 5 = 2，所這又相當於</p>
<pre><code class="lang-swift">2 + 2
</code></pre>
<p>計算結果為 4。</p>
<p>查閱Swift運算符的優先級和結合性的完整列表，請看<a href="../chapter3/04_Expressions.html">表達式</a>。</p>
<blockquote>
<p>注意：<br>Swift的運算符較C語言和Objective-C來得更簡單和保守，這意味著跟基於C的語言可能不一樣。所以，在移植已有代碼到Swift時，注意去確保代碼按你想的那樣去執行。</p>
</blockquote>
<p><a name="operator_functions"></a></p>
<h2 id="-">運算符函數</h2>
<p>讓已有的運算符也可以對自定義的類和結構進行運算，這稱為運算符重載。</p>
<p>這個例子展示了如何用<code>+</code>讓一個自定義的結構做加法。算術運算符<code>+</code>是一個兩目運算符，因為它有兩個操作數，而且它必須出現在兩個操作數之間。</p>
<p>例子中定義了一個名為<code>Vector2D</code>的二維坐標向量 <code>(x，y)</code> 的結構，然後定義了讓兩個<code>Vector2D</code>的對象相加的運算符函數。</p>
<pre><code class="lang-swift">struct Vector2D {
    var x = 0.0, y = 0.0
}
@infix func + (left: Vector2D, right: Vector2D) -&gt; Vector2D {
    return Vector2D(x: left.x + right.x, y: left.y + right.y)
}
</code></pre>
<p>該運算符函數定義了一個全局的<code>+</code>函數，這個函數需要兩個<code>Vector2D</code>類型的參數，返回值也是<code>Vector2D</code>類型。需要定義和實現一個中置運算的時候，在關鍵字<code>func</code>之前寫上屬性 <code>@infix</code> 就可以了。</p>
<p>在這個代碼實現中，參數被命名為了<code>left</code>和<code>right</code>，代表<code>+</code>左邊和右邊的兩個<code>Vector2D</code>對象。函數返回了一個新的<code>Vector2D</code>的對象，這個對象的<code>x</code>和<code>y</code>分別等於兩個參數對象的<code>x</code>和<code>y</code>的和。</p>
<p>這個函數是全局的，而不是<code>Vector2D</code>結構的成員方法，所以任意兩個<code>Vector2D</code>對象都可以使用這個中置運算符。</p>
<pre><code class="lang-swift">let vector = Vector2D(x: 3.0, y: 1.0)
let anotherVector = Vector2D(x: 2.0, y: 4.0)
let combinedVector = vector + anotherVector
// combinedVector 是一個新的Vector2D, 值為 (5.0, 5.0)
</code></pre>
<p>這個例子實現兩個向量 <code>(3.0，1.0)</code> 和 <code>(2.0，4.0)</code> 相加，得到向量 <code>(5.0，5.0)</code> 的過程。如下圖示：</p>
<p><img src="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Art/vectorAddition_2x.png" alt="Art/vectorAddition_2x.png" title="Art/vectorAddition_2x.png"></p>
<h3 id="-">前置和後置運算符</h3>
<p>上個例子演示了一個雙目中置運算符的自定義實現，同樣我們也可以玩標準單目運算符的實現。單目運算符只有一個操作數，在操作數之前就是前置的，如<code>-a</code>; 在操作數之後就是後置的，如<code>i++</code>。</p>
<p>實現一個前置或後置運算符時，在定義該運算符的時候於關鍵字<code>func</code>之前標注 <code>@prefix</code> 或 <code>@postfix</code> 屬性。</p>
<pre><code class="lang-swift">@prefix func - (vector: Vector2D) -&gt; Vector2D {
    return Vector2D(x: -vector.x, y: -vector.y)
}
</code></pre>
<p>這段代碼為<code>Vector2D</code>類型提供了單目減運算<code>-a</code>，<code>@prefix</code>屬性表明這是個前置運算符。</p>
<p>對於數值，單目減運算符可以把正數變負數，把負數變正數。對於<code>Vector2D</code>，單目減運算將其<code>x</code>和<code>y</code>都進進行單目減運算。</p>
<pre><code class="lang-swift">let positive = Vector2D(x: 3.0, y: 4.0)
let negative = -positive
// negative 為 (-3.0, -4.0)
let alsoPositive = -negative
// alsoPositive 為 (3.0, 4.0)
</code></pre>
<h3 id="-">組合賦值運算符</h3>
<p>組合賦值是其他運算符和賦值運算符一起執行的運算。如<code>+=</code>把加運算和賦值運算組合成一個操作。實現一個組合賦值符號需要使用<code>@assignment</code>屬性，還需要把運算符的左參數設置成<code>inout</code>，因為這個參數會在運算符函數內直接修改它的值。</p>
<pre><code class="lang-swift">@assignment func += (inout left: Vector2D, right: Vector2D) {
    left = left + right
}
</code></pre>
<p>因為加法運算在之前定義過了，這裡無需重新定義。所以，加賦運算符函數使用已經存在的高級加法運算符函數來執行左值加右值的運算。</p>
<pre><code class="lang-swift">var original = Vector2D(x: 1.0, y: 2.0)
let vectorToAdd = Vector2D(x: 3.0, y: 4.0)
original += vectorToAdd
// original 現在為 (4.0, 6.0)
</code></pre>
<p>你可以將 <code>@assignment</code> 屬性和 <code>@prefix</code> 或 <code>@postfix</code> 屬性起來組合，實現一個<code>Vector2D</code>的前置運算符。</p>
<pre><code class="lang-swift">@prefix @assignment func ++ (inout vector: Vector2D) -&gt; Vector2D {
    vector += Vector2D(x: 1.0, y: 1.0)
    return vector
}
</code></pre>
<p>這個前置使用了已經定義好的高級加賦運算，將自己加上一個值為 <code>(1.0，1.0)</code> 的對象然後賦給自己，然後再將自己返回。</p>
<pre><code class="lang-swift">var toIncrement = Vector2D(x: 3.0, y: 4.0)
let afterIncrement = ++toIncrement
// toIncrement 現在是 (4.0, 5.0)
// afterIncrement 現在也是 (4.0, 5.0)
</code></pre>
<blockquote>
<p>注意：<br>默認的賦值符是不可重載的。只有組合賦值符可以重載。三目條件運算符 <code>a？b：c</code> 也是不可重載。</p>
</blockquote>
<h3 id="-">比較運算符</h3>
<p>Swift無所知道自定義類型是否相等或不等，因為等於或者不等於由你的代碼說了算了。所以自定義的類和結構要使用比較符<code>==</code>或<code>!=</code>就需要重載。</p>
<p>定義相等運算符函數跟定義其他中置運算符雷同：</p>
<pre><code class="lang-swift">@infix func == (left: Vector2D, right: Vector2D) -&gt; Bool {
    return (left.x == right.x) &amp;&amp; (left.y == right.y)
}

@infix func != (left: Vector2D, right: Vector2D) -&gt; Bool {
    return !(left == right)
}
</code></pre>
<p>上述代碼實現了相等運算符<code>==</code>來判斷兩個<code>Vector2D</code>對象是否有相等的值，相等的概念就是它們有相同的<code>x</code>值和相同的<code>y</code>值，我們就用這個邏輯來實現。接著使用<code>==</code>的結果實現了不相等運算符<code>!=</code>。</p>
<p>現在我們可以使用這兩個運算符來判斷兩個<code>Vector2D</code>對象是否相等。</p>
<pre><code class="lang-swift">let twoThree = Vector2D(x: 2.0, y: 3.0)
let anotherTwoThree = Vector2D(x: 2.0, y: 3.0)
if twoThree == anotherTwoThree {
    println(&quot;這兩個向量是相等的.&quot;)
}
// prints &quot;這兩個向量是相等的.&quot;
</code></pre>
<h3 id="-">自定義運算符</h3>
<p>標準的運算符不夠玩，那你可以聲明一些個性的運算符，但個性的運算符只能使用這些字符 <code>/ = - + * % &lt; &gt;！&amp; | ^。~</code>。</p>
<p>新的運算符聲明需在全局域使用<code>operator</code>關鍵字聲明，可以聲明為前置，中置或後置的。</p>
<pre><code class="lang-swift">operator prefix +++ {}
</code></pre>
<p>這段代碼定義了一個新的前置運算符叫<code>+++</code>，此前Swift並不存在這個運算符。此處為了演示，我們讓<code>+++</code>對<code>Vector2D</code>對象的操作定義為 <code>雙自增</code> 這樣一個獨有的操作，這個操作使用了之前定義的加賦運算實現了自已加上自己然後返回的運算。</p>
<pre><code class="lang-swift">@prefix @assignment func +++ (inout vector: Vector2D) -&gt; Vector2D {
    vector += vector
    return vector
}
</code></pre>
<p><code>Vector2D</code> 的 <code>+++</code> 的實現和 <code>++</code> 的實現很接近, 唯一不同的前者是加自己, 後者是加值為 <code>(1.0, 1.0)</code> 的向量.</p>
<pre><code class="lang-swift">var toBeDoubled = Vector2D(x: 1.0, y: 4.0)
let afterDoubling = +++toBeDoubled
// toBeDoubled 現在是 (2.0, 8.0)
// afterDoubling 現在也是 (2.0, 8.0)
</code></pre>
<h3 id="-">自定義中置運算符的優先級和結合性</h3>
<p>可以為自定義的中置運算符指定優先級和結合性。可以回頭看看<a href="#PrecedenceandAssociativity">優先級和結合性</a>解釋這兩個因素是如何影響多種中置運算符混合的表達式的計算的。</p>
<p>結合性(associativity)的值可取的值有<code>left</code>，<code>right</code>和<code>none</code>。左結合運算符跟其他優先級相同的左結合運算符寫在一起時，會跟左邊的操作數結合。同理，右結合運算符會跟右邊的操作數結合。而非結合運算符不能跟其他相同優先級的運算符寫在一起。</p>
<p>結合性(associativity)的值默認為<code>none</code>，優先級(precedence)默認為<code>100</code>。</p>
<p>以下例子定義了一個新的中置符<code>+-</code>，是左結合的<code>left</code>，優先級為<code>140</code>。</p>
<pre><code class="lang-swift">operator infix +- { associativity left precedence 140 }
func +- (left: Vector2D, right: Vector2D) -&gt; Vector2D {
    return Vector2D(x: left.x + right.x, y: left.y - right.y)
}
let firstVector = Vector2D(x: 1.0, y: 2.0)
let secondVector = Vector2D(x: 3.0, y: 4.0)
let plusMinusVector = firstVector +- secondVector
// plusMinusVector 此時的值為 (4.0, -2.0)
</code></pre>
<p>這個運算符把兩個向量的<code>x</code>相加，把向量的<code>y</code>相減。因為他實際是屬於加減運算，所以讓它保持了和加法一樣的結合性和優先級(<code>left</code>和<code>140</code>)。查閱完整的Swift默認結合性和優先級的設置，請移步<a href="../chapter3/04_Expressions.html">表達式</a>;</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../chapter2/22_Generics.html" class="navigation navigation-prev " aria-label="Previous page: 泛型"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../chapter3/chapter3.html" class="navigation navigation-next " aria-label="Next page: 語言參考"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../gitbook/app.js"></script>

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    <script src="http://yandex.st/highlightjs/8.0/styles/default.min.css"></script><script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script><script text="javascript">$('pre code').each(function(i, block) {hljs.highlightBlock(block);});</script></body>
    
</html>
